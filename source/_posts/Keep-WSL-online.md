---
title: 保持WSL后台在线
date: 2024-10-29 22:08:33
tags:
---
默认情况下，当你关闭最后一个wsl终端后，wsl会直接退出。如果有服务要在后台运行，可以采取以下方法：

1. 编写vbs脚本"init.vbs"
```vbs
set ws = CreateObject("WScript.Shell")
ws.Run "wsl -d Debian", 0
```
其中 Debian请替换为你所要运行的实例名称

2. 执行vbs脚本
- 可以直接双击执行，或`wscript init.vbs`
- 如果想开机启动wsl，搜索“任务计划程序”，创建任务，安全选项为“不管用户是否登录都要运行”，触发器为“在系统启动时”，操作为“启动程序”，然后找到你刚刚编写的脚本添加为启动该程序。

**注意**：不要修改vbs脚本的默认打开方式，例如用记事本打开，这样会导致任务计划程序为“用记事本打开vbs脚本”，而不是执行该脚本